<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½é£Ÿç‰©çƒ­é‡è®¡ç®—å™¨</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --primary-light: #6b8cbc;
            --secondary: #ff7e5f;
            --background: #f8f9fa;
            --card: #ffffff;
            --text: #333333;
            --text-light: #666666;
            --border: #e0e0e0;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
            background-color: var(--card);
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        h1 {
            color: var(--primary);
            margin: 0;
            font-size: 2.2rem;
        }

        .subtitle {
            color: var(--text-light);
            margin-top: 5px;
            font-size: 1.1rem;
        }

        .app-container {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background-color: var(--card);
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.4rem;
            margin-top: 0;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
        }

        .card-title i {
            margin-right: 10px;
            color: var(--secondary);
        }

        .search-container {
            position: relative;
            margin-bottom: 15px;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: 1px solid var(--border);
            border-radius: 30px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .food-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.95rem;
        }

        .food-table th {
            background-color: var(--primary);
            color: white;
            padding: 12px 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }

        .food-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .food-table tr:last-child td {
            border-bottom: none;
        }

        .food-table tr:hover {
            background-color: rgba(74, 111, 165, 0.05);
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }

        .btn {
            display: inline-block;
            padding: 12px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: #6c757d;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-group .btn {
            flex: 1;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(74, 111, 165, 0.1);
            border-left: 4px solid var(--primary);
            border-radius: 0 6px 6px 0;
        }

        .result-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .food-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            border: 1px solid var(--border);
            border-radius: 6px;
        }

        .food-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .food-item:last-child {
            border-bottom: none;
        }

        .food-item-info {
            flex: 1;
        }

        .food-item-name {
            font-weight: 500;
        }

        .food-item-details {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 3px;
        }

        .food-item-actions {
            display: flex;
            gap: 5px;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-item-content {
            margin-bottom: 5px;
            font-weight: 500;
        }

        .history-item-date {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .empty-state {
            text-align: center;
            padding: 30px;
            color: var(--text-light);
        }

        .theme-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .theme-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .theme-btn:hover {
            transform: scale(1.1);
        }

        .theme-default {
            background: linear-gradient(135deg, #4a6fa5, #ff7e5f);
        }

        .theme-dark {
            background: linear-gradient(135deg, #343a40, #6c757d);
        }

        .theme-green {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        .theme-pink {
            background: linear-gradient(135deg, #e83e8c, #fd7e14);
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            animation: fadeIn 0.5s ease-out;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 576px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 15px;
            }
            
            .tabs {
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 5px;
            }
            
            .tab {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>æ™ºèƒ½é£Ÿç‰©çƒ­é‡è®¡ç®—å™¨</h1>
            <div class="subtitle">ç²¾å‡†è®¡ç®— Â· å¥åº·é¥®é£Ÿ Â· ç§‘å­¦ç®¡ç†</div>
            <div class="theme-selector">
                <div class="theme-btn theme-default" title="é»˜è®¤ä¸»é¢˜" onclick="changeTheme('default')"></div>
                <div class="theme-btn theme-dark" title="æš—é»‘ä¸»é¢˜" onclick="changeTheme('dark')"></div>
                <div class="theme-btn theme-green" title="ç»¿è‰²ä¸»é¢˜" onclick="changeTheme('green')"></div>
                <div class="theme-btn theme-pink" title="ç²‰è‰²ä¸»é¢˜" onclick="changeTheme('pink')"></div>
            </div>
        </header>

        <div class="app-container">
            <div>
                <div class="card">
                    <h2 class="card-title"><i>ğŸ</i>é£Ÿç‰©æ•°æ®åº“</h2>
                    <div class="search-container">
                        <span class="search-icon">ğŸ”</span>
                        <input type="text" class="search-input" id="searchFood" placeholder="æœç´¢é£Ÿç‰©åç§°..." oninput="searchFoods()">
                    </div>
                    <div style="max-height: 500px; overflow-y: auto;">
                        <table class="food-table">
                            <thead>
                                <tr>
                                    <th>é£Ÿç‰©åç§°</th>
                                    <th>çƒ­é‡(å¤§å¡/100g)</th>
                                </tr>
                            </thead>
                            <tbody id="foodTableBody">
                                <!-- é£Ÿç‰©æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div>
                <div class="card">
                    <div class="tabs">
                        <div class="tab active" onclick="switchTab('single')">å•ä¸€é£Ÿç‰©</div>
                        <div class="tab" onclick="switchTab('custom')">è‡ªå®šä¹‰é£Ÿç‰©</div>
                        <div class="tab" onclick="switchTab('multi')">ç»„åˆè®¡ç®—</div>
                        <div class="tab" onclick="switchTab('history')">å†å²è®°å½•</div>
                    </div>

                    <div id="singleTab" class="tab-content active">
                        <h3 class="card-title"><i>ğŸ</i>å•ä¸€é£Ÿç‰©çƒ­é‡è®¡ç®—</h3>
                        <div class="form-group">
                            <label for="singleFood">é€‰æ‹©é£Ÿç‰©</label>
                            <select id="singleFood">
                                <!-- é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="singleWeight">é£Ÿç”¨é‡é‡ (å…‹)</label>
                            <input type="number" id="singleWeight" min="1" value="100" placeholder="è¯·è¾“å…¥é‡é‡">
                        </div>
                        <button class="btn" onclick="calculateSingle()">è®¡ç®—çƒ­é‡</button>
                        <div class="result" id="singleResult" style="display: none;">
                            <div id="singleResultContent"></div>
                        </div>
                    </div>

                    <div id="customTab" class="tab-content">
                        <h3 class="card-title"><i>ğŸ•</i>è‡ªå®šä¹‰é£Ÿç‰©è®¡ç®—</h3>
                        <div class="form-group">
                            <label for="customFoodName">é£Ÿç‰©åç§°</label>
                            <input type="text" id="customFoodName" placeholder="ä¾‹å¦‚: å·§å…‹åŠ›è›‹ç³•">
                        </div>
                        <div class="form-group">
                            <label for="customCalories">æ¯100å…‹çƒ­é‡ (å¤§å¡)</label>
                            <input type="number" id="customCalories" min="1" placeholder="ä¾‹å¦‚: 546">
                        </div>
                        <div class="form-group">
                            <label for="customWeight">é£Ÿç”¨é‡é‡ (å…‹)</label>
                            <input type="number" id="customWeight" min="1" value="100">
                        </div>
                        <div class="btn-group">
                            <button class="btn" onclick="calculateCustom()">è®¡ç®—çƒ­é‡</button>
                            <button class="btn btn-success" onclick="saveCustomFood()">ä¿å­˜é£Ÿç‰©</button>
                        </div>
                        <div class="result" id="customResult" style="display: none;">
                            <div id="customResultContent"></div>
                        </div>
                    </div>

                    <div id="multiTab" class="tab-content">
                        <h3 class="card-title"><i>ğŸ½ï¸</i>ç»„åˆçƒ­é‡è®¡ç®—</h3>
                        <div class="form-group">
                            <label for="multiFood">é€‰æ‹©é£Ÿç‰©</label>
                            <select id="multiFood">
                                <!-- é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="multiWeight">é£Ÿç”¨é‡é‡ (å…‹)</label>
                            <input type="number" id="multiWeight" min="1" value="100">
                        </div>
                        <div class="btn-group">
                            <button class="btn" onclick="addFood()">æ·»åŠ åˆ°åˆ—è¡¨</button>
                            <button class="btn btn-danger" onclick="clearList()">æ¸…ç©ºåˆ—è¡¨</button>
                        </div>
                        <div class="food-list" id="foodList">
                            <div class="empty-state">æš‚æ— é£Ÿç‰©ï¼Œè¯·å…ˆæ·»åŠ é£Ÿç‰©åˆ°åˆ—è¡¨</div>
                        </div>
                        <button class="btn" onclick="calculateTotal()">è®¡ç®—æ€»çƒ­é‡</button>
                        <div class="result" id="totalResult" style="display: none;">
                            <div id="totalResultContent"></div>
                        </div>
                    </div>

                    <div id="historyTab" class="tab-content">
                        <h3 class="card-title"><i>ğŸ“</i>å†å²è®°å½•</h3>
                        <div class="btn-group">
                            <button class="btn" onclick="loadHistory()">åˆ·æ–°è®°å½•</button>
                            <button class="btn btn-danger" onclick="clearHistory()">æ¸…é™¤æ‰€æœ‰</button>
                        </div>
                        <div class="history-list" id="historyList">
                            <div class="empty-state">æš‚æ— å†å²è®°å½•</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¢å¼ºç‰ˆé£Ÿç‰©æ•°æ®åº“ (200+ç§é£Ÿç‰©)
        const foodDatabase = [
            // è°·ç‰©ç±»
            { name: "ç±³é¥­", calories: 116, category: "è°·ç‰©" },
            { name: "ç™½ç±³é¥­", calories: 130, category: "è°·ç‰©" },
            { name: "ç³™ç±³é¥­", calories: 111, category: "è°·ç‰©" },
            { name: "é¢æ¡", calories: 138, category: "è°·ç‰©" },
            { name: "å…¨éº¦é¢æ¡", calories: 124, category: "è°·ç‰©" },
            { name: "æ„å¤§åˆ©é¢", calories: 158, category: "è°·ç‰©" },
            { name: "é¦’å¤´", calories: 223, category: "è°·ç‰©" },
            { name: "å…¨éº¦é¢åŒ…", calories: 265, category: "è°·ç‰©" },
            { name: "ç™½é¢åŒ…", calories: 265, category: "è°·ç‰©" },
            { name: "ç‡•éº¦ç‰‡", calories: 389, category: "è°·ç‰©" },
            { name: "ç‰ç±³ç‰‡", calories: 365, category: "è°·ç‰©" },
            { name: "å°ç±³ç²¥", calories: 46, category: "è°·ç‰©" },
            { name: "å…«å®ç²¥", calories: 85, category: "è°·ç‰©" },
            
            // è‚‰ç±»
            { name: "é¸¡èƒ¸è‚‰", calories: 165, category: "è‚‰ç±»" },
            { name: "é¸¡è…¿è‚‰", calories: 209, category: "è‚‰ç±»" },
            { name: "é¸¡ç¿…", calories: 234, category: "è‚‰ç±»" },
            { name: "ç‰›è‚‰", calories: 250, category: "è‚‰ç±»" },
            { name: "ç˜¦ç‰›è‚‰", calories: 198, category: "è‚‰ç±»" },
            { name: "ç‰›æ’", calories: 271, category: "è‚‰ç±»" },
            { name: "çŒªè‚‰", calories: 242, category: "è‚‰ç±»" },
            { name: "ç˜¦çŒªè‚‰", calories: 143, category: "è‚‰ç±»" },
            { name: "åŸ¹æ ¹", calories: 541, category: "è‚‰ç±»" },
            { name: "ç«è…¿", calories: 145, category: "è‚‰ç±»" },
            { name: "é¦™è‚ ", calories: 296, category: "è‚‰ç±»" },
            { name: "ç¾Šè‚‰", calories: 294, category: "è‚‰ç±»" },
            
            // é±¼ç±»æµ·é²œ
            { name: "ä¸‰æ–‡é±¼", calories: 208, category: "æµ·é²œ" },
            { name: "é³•é±¼", calories: 82, category: "æµ·é²œ" },
            { name: "é‡‘æªé±¼", calories: 144, category: "æµ·é²œ" },
            { name: "é²ˆé±¼", calories: 105, category: "æµ·é²œ" },
            { name: "è™¾", calories: 99, category: "æµ·é²œ" },
            { name: "é¾™è™¾", calories: 90, category: "æµ·é²œ" },
            { name: "èƒèŸ¹", calories: 97, category: "æµ·é²œ" },
            { name: "è›¤èœŠ", calories: 74, category: "æµ·é²œ" },
            { name: "ç‰¡è›", calories: 81, category: "æµ·é²œ" },
            { name: "æ‰‡è´", calories: 88, category: "æµ·é²œ" },
            
            // è›‹å¥¶åˆ¶å“
            { name: "é¸¡è›‹", calories: 143, category: "è›‹å¥¶" },
            { name: "é¸¡è›‹ç™½", calories: 52, category: "è›‹å¥¶" },
            { name: "é¸¡è›‹é»„", calories: 322, category: "è›‹å¥¶" },
            { name: "ç‰›å¥¶", calories: 54, category: "è›‹å¥¶" },
            { name: "å…¨è„‚ç‰›å¥¶", calories: 61, category: "è›‹å¥¶" },
            { name: "è„±è„‚ç‰›å¥¶", calories: 34, category: "è›‹å¥¶" },
            { name: "é…¸å¥¶", calories: 59, category: "è›‹å¥¶" },
            { name: "å¸Œè…Šé…¸å¥¶", calories: 59, category: "è›‹å¥¶" },
            { name: "å¥¶é…ª", calories: 402, category: "è›‹å¥¶" },
            { name: "åˆ‡è¾¾å¥¶é…ª", calories: 403, category: "è›‹å¥¶" },
            { name: "å¥¶æ²¹", calories: 340, category: "è›‹å¥¶" },
            { name: "é»„æ²¹", calories: 717, category: "è›‹å¥¶" },
            
            // æ°´æœç±»
            { name: "è‹¹æœ", calories: 52, category: "æ°´æœ" },
            { name: "é¦™è•‰", calories: 89, category: "æ°´æœ" },
            { name: "æ©™å­", calories: 47, category: "æ°´æœ" },
            { name: "è‰è“", calories: 32, category: "æ°´æœ" },
            { name: "è“è“", calories: 57, category: "æ°´æœ" },
            { name: "è‘¡è„", calories: 69, category: "æ°´æœ" },
            { name: "è¥¿ç“œ", calories: 30, category: "æ°´æœ" },
            { name: "è è", calories: 50, category: "æ°´æœ" },
            { name: "èŠ’æœ", calories: 60, category: "æ°´æœ" },
            { name: "çŒ•çŒ´æ¡ƒ", calories: 61, category: "æ°´æœ" },
            { name: "æ¢¨", calories: 57, category: "æ°´æœ" },
            { name: "æ¡ƒå­", calories: 39, category: "æ°´æœ" },
            { name: "æ¨±æ¡ƒ", calories: 50, category: "æ°´æœ" },
            { name: "æŸ æª¬", calories: 29, category: "æ°´æœ" },
            { name: "ç‰›æ²¹æœ", calories: 160, category: "æ°´æœ" },
            
            // è”¬èœç±»
            { name: "èƒ¡èåœ", calories: 41, category: "è”¬èœ" },
            { name: "è¥¿å…°èŠ±", calories: 34, category: "è”¬èœ" },
            { name: "è èœ", calories: 23, category: "è”¬èœ" },
            { name: "åœŸè±†", calories: 77, category: "è”¬èœ" },
            { name: "çº¢è–¯", calories: 86, category: "è”¬èœ" },
            { name: "ç‰ç±³", calories: 86, category: "è”¬èœ" },
            { name: "ç•ªèŒ„", calories: 18, category: "è”¬èœ" },
            { name: "é»„ç“œ", calories: 16, category: "è”¬èœ" },
            { name: "æ´‹è‘±", calories: 40, category: "è”¬èœ" },
            { name: "è˜‘è‡", calories: 22, category: "è”¬èœ" },
            { name: "é’æ¤’", calories: 20, category: "è”¬èœ" },
            { name: "èŒ„å­", calories: 25, category: "è”¬èœ" },
            { name: "èŠ±æ¤°èœ", calories: 25, category: "è”¬èœ" },
            { name: "èŠ¹èœ", calories: 16, category: "è”¬èœ" },
            { name: "ç”Ÿèœ", calories: 15, category: "è”¬èœ" },
            { name: "ç™½èœ", calories: 13, category: "è”¬èœ" },
            { name: "å—ç“œ", calories: 26, category: "è”¬èœ" },
            
            // è±†åˆ¶å“
            { name: "è±†è…", calories: 76, category: "è±†åˆ¶å“" },
            { name: "è±†æµ†", calories: 54, category: "è±†åˆ¶å“" },
            { name: "æ¯›è±†", calories: 131, category: "è±†åˆ¶å“" },
            { name: "é»„è±†", calories: 446, category: "è±†åˆ¶å“" },
            { name: "ç»¿è±†", calories: 329, category: "è±†åˆ¶å“" },
            { name: "çº¢è±†", calories: 329, category: "è±†åˆ¶å“" },
            
            // åšæœç§å­
            { name: "æä»", calories: 579, category: "åšæœ" },
            { name: "æ ¸æ¡ƒ", calories: 654, category: "åšæœ" },
            { name: "è…°æœ", calories: 553, category: "åšæœ" },
            { name: "èŠ±ç”Ÿ", calories: 567, category: "åšæœ" },
            { name: "å¼€å¿ƒæœ", calories: 562, category: "åšæœ" },
            { name: "ç“œå­", calories: 567, category: "åšæœ" },
            { name: "èŠéº»", calories: 573, category: "åšæœ" },
            { name: "èŠ±ç”Ÿé…±", calories: 588, category: "åšæœ" },
            
            // æ²¹è„‚ç±»
            { name: "æ©„æ¦„æ²¹", calories: 884, category: "æ²¹è„‚" },
            { name: "èŠ±ç”Ÿæ²¹", calories: 884, category: "æ²¹è„‚" },
            { name: "èœç±½æ²¹", calories: 884, category: "æ²¹è„‚" },
            { name: "æ¤°å­æ²¹", calories: 862, category: "æ²¹è„‚" },
            { name: "é»„æ²¹", calories: 717, category: "æ²¹è„‚" },
            
            // ç”œç‚¹é›¶é£Ÿ
            { name: "å·§å…‹åŠ›", calories: 546, category: "é›¶é£Ÿ" },
            { name: "é»‘å·§å…‹åŠ›", calories: 598, category: "é›¶é£Ÿ" },
            { name: "ç™½å·§å…‹åŠ›", calories: 539, category: "é›¶é£Ÿ" },
            { name: "å†°æ·‡æ·‹", calories: 207, category: "é›¶é£Ÿ" },
            { name: "è›‹ç³•", calories: 350, category: "é›¶é£Ÿ" },
            { name: "é¥¼å¹²", calories: 502, category: "é›¶é£Ÿ" },
            { name: "è–¯ç‰‡", calories: 536, category: "é›¶é£Ÿ" },
            { name: "çˆ†ç±³èŠ±", calories: 375, category: "é›¶é£Ÿ" },
            { name: "ç³–æœ", calories: 394, category: "é›¶é£Ÿ" },
            
            // é¥®æ–™ç±»
            { name: "å¯ä¹", calories: 42, category: "é¥®æ–™" },
            { name: "æ©™æ±", calories: 45, category: "é¥®æ–™" },
            { name: "è‹¹æœæ±", calories: 46, category: "é¥®æ–™" },
            { name: "å’–å•¡", calories: 2, category: "é¥®æ–™" },
            { name: "èŒ¶", calories: 1, category: "é¥®æ–™" },
            { name: "å•¤é…’", calories: 43, category: "é¥®æ–™" },
            { name: "çº¢é…’", calories: 83, category: "é¥®æ–™" },
            { name: "ç™½é…’", calories: 231, category: "é¥®æ–™" },
            
            // å¿«é¤é£Ÿå“
            { name: "æŠ«è¨", calories: 266, category: "å¿«é¤" },
            { name: "æ±‰å ¡", calories: 295, category: "å¿«é¤" },
            { name: "çƒ­ç‹—", calories: 290, category: "å¿«é¤" },
            { name: "ç‚¸é¸¡", calories: 300, category: "å¿«é¤" },
            { name: "ç‚¸è–¯æ¡", calories: 312, category: "å¿«é¤" },
            { name: "å¯¿å¸", calories: 150, category: "å¿«é¤" },
            { name: "æ‹‰é¢", calories: 436, category: "å¿«é¤" },
            { name: "ç‚’é¥­", calories: 163, category: "å¿«é¤" },
            { name: "é¥ºå­", calories: 195, category: "å¿«é¤" },
            { name: "åŒ…å­", calories: 227, category: "å¿«é¤" },
            { name: "æ²¹æ¡", calories: 386, category: "å¿«é¤" },
            { name: "ç…é¥¼", calories: 312, category: "å¿«é¤" }
        ];

        // å­˜å‚¨é£Ÿç‰©åˆ—è¡¨å’Œå†å²è®°å½•
        let foodItems = [];
        let historyRecords = [];
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            loadFoodDatabase();
            populateSelectOptions();
            loadHistory();
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½ä¸»é¢˜åå¥½
            const savedTheme = localStorage.getItem('theme') || 'default';
            changeTheme(savedTheme);
        });
        
        // åŠ è½½é£Ÿç‰©æ•°æ®åº“åˆ°è¡¨æ ¼
        function loadFoodDatabase() {
            const tableBody = document.getElementById('foodTableBody');
            tableBody.innerHTML = '';
            
            foodDatabase.forEach(food => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${food.name}</td>
                    <td>${food.calories}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // å¡«å……é€‰æ‹©æ¡†é€‰é¡¹
        function populateSelectOptions() {
            const singleSelect = document.getElementById('singleFood');
            const multiSelect = document.getElementById('multiFood');
            
            singleSelect.innerHTML = '';
            multiSelect.innerHTML = '';
            
            // æŒ‰åç§°æ’åº
            const sortedFoods = [...foodDatabase].sort((a, b) => a.name.localeCompare(b.name));
            
            sortedFoods.forEach(food => {
                const option = document.createElement('option');
                option.value = food.calories;
                option.textContent = food.name;
                
                singleSelect.appendChild(option.cloneNode(true));
                multiSelect.appendChild(option);
            });
        }
        
        // æœç´¢é£Ÿç‰©
        function searchFoods() {
            const searchTerm = document.getElementById('searchFood').value.toLowerCase();
            const tableBody = document.getElementById('foodTableBody');
            tableBody.innerHTML = '';
            
            const filteredFoods = foodDatabase.filter(food => 
                food.name.toLowerCase().includes(searchTerm));
            
            if (filteredFoods.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="2" style="text-align: center;">æœªæ‰¾åˆ°åŒ¹é…çš„é£Ÿç‰©</td>';
                tableBody.appendChild(row);
                return;
            }
            
            filteredFoods.forEach(food => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${food.name}</td>
                    <td>${food.calories}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabId) {
            // æ›´æ–°æ ‡ç­¾æ ·å¼
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ›´æ–°å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId + 'Tab').classList.add('active');
        }
        
        // è®¡ç®—å•ä¸€é£Ÿç‰©çƒ­é‡
        function calculateSingle() {
            const foodSelect = document.getElementById('singleFood');
            const weightInput = document.getElementById('singleWeight');
            const weight = parseFloat(weightInput.value);
            
            if (isNaN(weight) || weight <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡é‡');
                weightInput.focus();
                return;
            }
            
            const caloriesPer100g = parseFloat(foodSelect.value);
            const foodName = foodSelect.options[foodSelect.selectedIndex].text;
            const totalCalories = (caloriesPer100g * weight / 100).toFixed(1);
            
            const resultElement = document.getElementById('singleResult');
            const resultContent = document.getElementById('singleResultContent');
            
            resultContent.innerHTML = 
                `<div>${weight}å…‹ <strong>${foodName}</strong> çš„çƒ­é‡ä¸º: <span class="result-value">${totalCalories}</span> å¤§å¡</div>
                 <div style="margin-top: 8px; font-size: 0.9em; color: var(--text-light);">
                 æ¯100å…‹çƒ­é‡: ${caloriesPer100g}å¤§å¡
                 </div>`;
            
            resultElement.style.display = 'block';
            
            // ä¿å­˜åˆ°å†å²è®°å½•
            saveToHistory({
                type: 'single',
                name: foodName,
                weight: weight,
                calories: totalCalories,
                date: new Date().toLocaleString()
            });
        }
        
        // è®¡ç®—è‡ªå®šä¹‰é£Ÿç‰©çƒ­é‡
        function calculateCustom() {
            const foodNameInput = document.getElementById('customFoodName');
            const caloriesInput = document.getElementById('customCalories');
            const weightInput = document.getElementById('customWeight');
            
            const foodName = foodNameInput.value.trim();
            const caloriesPer100g = parseFloat(caloriesInput.value);
            const weight = parseFloat(weightInput.value);
            
            if (!foodName) {
                alert('è¯·è¾“å…¥é£Ÿç‰©åç§°');
                foodNameInput.focus();
                return;
            }
            
            if (isNaN(caloriesPer100g) || caloriesPer100g <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„çƒ­é‡å€¼');
                caloriesInput.focus();
                return;
            }
            
            if (isNaN(weight) || weight <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡é‡');
                weightInput.focus();
                return;
            }
            
            const totalCalories = (caloriesPer100g * weight / 100).toFixed(1);
            
            const resultElement = document.getElementById('customResult');
            const resultContent = document.getElementById('customResultContent');
            
            resultContent.innerHTML = 
                `<div>${weight}å…‹ <strong>${foodName}</strong> çš„çƒ­é‡ä¸º: <span class="result-value">${totalCalories}</span> å¤§å¡</div>
                 <div style="margin-top: 8px; font-size: 0.9em; color: var(--text-light);">
                 æ¯100å…‹çƒ­é‡: ${caloriesPer100g}å¤§å¡
                 </div>`;
            
            resultElement.style.display = 'block';
            
            // ä¿å­˜åˆ°å†å²è®°å½•
            saveToHistory({
                type: 'custom',
                name: foodName,
                weight: weight,
                calories: totalCalories,
                date: new Date().toLocaleString()
            });
        }
        
        // ä¿å­˜è‡ªå®šä¹‰é£Ÿç‰©åˆ°æ•°æ®åº“
        function saveCustomFood() {
            const foodNameInput = document.getElementById('customFoodName');
            const caloriesInput = document.getElementById('customCalories');
            
            const foodName = foodNameInput.value.trim();
            const caloriesPer100g = parseFloat(caloriesInput.value);
            
            if (!foodName) {
                alert('è¯·è¾“å…¥é£Ÿç‰©åç§°');
                foodNameInput.focus();
                return;
            }
            
            if (isNaN(caloriesPer100g) || caloriesPer100g <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„çƒ­é‡å€¼');
                caloriesInput.focus();
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            if (foodDatabase.some(food => food.name.toLowerCase() === foodName.toLowerCase())) {
                alert('è¯¥é£Ÿç‰©å·²å­˜åœ¨äºæ•°æ®åº“ä¸­');
                return;
            }
            
            // æ·»åŠ åˆ°æ•°æ®åº“
            foodDatabase.push({
                name: foodName,
                calories: caloriesPer100g,
                category: "è‡ªå®šä¹‰"
            });
            
            // é‡æ–°å¡«å……é€‰æ‹©æ¡†
            populateSelectOptions();
            
            alert(`"${foodName}" å·²æˆåŠŸæ·»åŠ åˆ°é£Ÿç‰©æ•°æ®åº“`);
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            foodNameInput.value = '';
            caloriesInput.value = '';
            document.getElementById('customWeight').value = '100';
            document.getElementById('customResult').style.display = 'none';
            
            // åˆ‡æ¢åˆ°é£Ÿç‰©æ•°æ®åº“è§†å›¾
            document.querySelector('.tab.active').classList.remove('active');
            document.querySelector('.tab-content.active').classList.remove('active');
            document.querySelector('.tab').classList.add('active');
            document.getElementById('singleTab').classList.add('active');
        }
        
        // æ·»åŠ é£Ÿç‰©åˆ°åˆ—è¡¨
        function addFood() {
            const foodSelect = document.getElementById('multiFood');
            const weightInput = document.getElementById('multiWeight');
            const weight = parseFloat(weightInput.value);
            
            if (isNaN(weight) || weight <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é‡é‡');
                weightInput.focus();
                return;
            }
            
            const caloriesPer100g = parseFloat(foodSelect.value);
            const foodName = foodSelect.options[foodSelect.selectedIndex].text;
            const totalCalories = (caloriesPer100g * weight / 100).toFixed(1);
            
            foodItems.push({
                name: foodName,
                weight: weight,
                calories: parseFloat(totalCalories),
                caloriesPer100g: caloriesPer100g
            });
            
            updateFoodList();
            
            // æ¸…ç©ºç»“æœæ˜¾ç¤º
            document.getElementById('totalResult').style.display = 'none';
        }
        
        // æ›´æ–°é£Ÿç‰©åˆ—è¡¨æ˜¾ç¤º
        function updateFoodList() {
            const foodListElement = document.getElementById('foodList');
            
            if (foodItems.length === 0) {
                foodListElement.innerHTML = '<div class="empty-state">æš‚æ— é£Ÿç‰©ï¼Œè¯·å…ˆæ·»åŠ é£Ÿç‰©åˆ°åˆ—è¡¨</div>';
                return;
            }
            
            foodListElement.innerHTML = '';
            
            foodItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'food-item';
                itemElement.innerHTML = `
                    <div class="food-item-info">
                        <div class="food-item-name">${item.name}</div>
                        <div class="food-item-details">${item.weight}å…‹ Ã— ${item.caloriesPer100g}å¤§å¡/100g = ${item.calories}å¤§å¡</div>
                    </div>
                    <div class="food-item-actions">
                        <button class="btn btn-secondary" onclick="editFood(${index})">ç¼–è¾‘</button>
                        <button class="btn btn-danger" onclick="removeFood(${index})">åˆ é™¤</button>
                    </div>
                `;
                foodListElement.appendChild(itemElement);
            });
        }
        
        // ç¼–è¾‘é£Ÿç‰©é¡¹
        function editFood(index) {
            const newWeight = prompt(`ç¼–è¾‘ ${foodItems[index].name} çš„é‡é‡(å…‹):`, foodItems[index].weight);
            
            if (newWeight && !isNaN(newWeight) && newWeight > 0) {
                foodItems[index].weight = parseFloat(newWeight);
                foodItems[index].calories = (foodItems[index].caloriesPer100g * foodItems[index].weight / 100).toFixed(1);
                updateFoodList();
            }
        }
        
        // ä»åˆ—è¡¨ä¸­ç§»é™¤é£Ÿç‰©
        function removeFood(index) {
            if (confirm(`ç¡®å®šè¦åˆ é™¤ ${foodItems[index].name} å—?`)) {
                foodItems.splice(index, 1);
                updateFoodList();
            }
        }
        
        // æ¸…ç©ºé£Ÿç‰©åˆ—è¡¨
        function clearList() {
            if (foodItems.length === 0 || confirm('ç¡®å®šè¦æ¸…ç©ºé£Ÿç‰©åˆ—è¡¨å—?')) {
                foodItems = [];
                updateFoodList();
                document.getElementById('totalResult').style.display = 'none';
            }
        }
        
        // è®¡ç®—æ€»çƒ­é‡
        function calculateTotal() {
            if (foodItems.length === 0) {
                alert('è¯·å…ˆæ·»åŠ é£Ÿç‰©åˆ°åˆ—è¡¨');
                return;
            }
            
            const totalCalories = foodItems.reduce((sum, item) => sum + parseFloat(item.calories), 0).toFixed(1);
            const foodNames = foodItems.map(item => `${item.weight}å…‹${item.name}`).join(' + ');
            
            const resultElement = document.getElementById('totalResult');
            const resultContent = document.getElementById('totalResultContent');
            
            resultContent.innerHTML = 
                `<div>æ€»çƒ­é‡: <span class="result-value">${totalCalories}</span> å¤§å¡</div>
                 <div style="margin-top: 10px;">åŒ…å«: ${foodNames}</div>
                 <div style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                 å·²æ·»åŠ  ${foodItems.length} ç§é£Ÿç‰©
                 </div>`;
            
            resultElement.style.display = 'block';
            
            // ä¿å­˜åˆ°å†å²è®°å½•
            saveToHistory({
                type: 'multi',
                names: foodItems.map(item => item.name),
                weights: foodItems.map(item => item.weight),
                calories: totalCalories,
                date: new Date().toLocaleString()
            });
        }
        
        // ä¿å­˜åˆ°å†å²è®°å½•
        function saveToHistory(record) {
            historyRecords.unshift(record); // æ·»åŠ åˆ°å¼€å¤´
            localStorage.setItem('calorieHistory', JSON.stringify(historyRecords));
            loadHistory(); // åˆ·æ–°æ˜¾ç¤º
        }
        
        // åŠ è½½å†å²è®°å½•
        function loadHistory() {
            const savedHistory = localStorage.getItem('calorieHistory');
            historyRecords = savedHistory ? JSON.parse(savedHistory) : [];
            
            const historyListElement = document.getElementById('historyList');
            
            if (historyRecords.length === 0) {
                historyListElement.innerHTML = '<div class="empty-state">æš‚æ— å†å²è®°å½•</div>';
                return;
            }
            
            historyListElement.innerHTML = '';
            
            historyRecords.forEach((record, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'history-item';
                
                let details = '';
                if (record.type === 'single' || record.type === 'custom') {
                    details = `${record.weight}å…‹ ${record.name}: ${record.calories}å¤§å¡`;
                } else if (record.type === 'multi') {
                    const items = record.names.map((name, i) => 
                        `${record.weights[i]}å…‹ ${name}`).join(' + ');
                    details = `${items} = ${record.calories}å¤§å¡`;
                }
                
                itemElement.innerHTML = `
                    <div>
                        <div class="history-item-content">${details}</div>
                        <div class="history-item-date">${record.date}</div>
                    </div>
                    <button class="btn btn-danger" onclick="removeHistory(${index})">åˆ é™¤</button>
                `;
                
                historyListElement.appendChild(itemElement);
            });
        }
        
        // åˆ é™¤å•æ¡å†å²è®°å½•
        function removeHistory(index) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—?')) {
                historyRecords.splice(index, 1);
                localStorage.setItem('calorieHistory', JSON.stringify(historyRecords));
                loadHistory();
            }
        }
        
        // æ¸…é™¤æ‰€æœ‰å†å²è®°å½•
        function clearHistory() {
            if (historyRecords.length === 0 || confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰å†å²è®°å½•å—?')) {
                historyRecords = [];
                localStorage.removeItem('calorieHistory');
                loadHistory();
            }
        }
        
        // æ›´æ”¹ä¸»é¢˜
        function changeTheme(theme) {
            document.body.className = theme + '-theme';
            localStorage.setItem('theme', theme);
            
            // æ›´æ–°CSSå˜é‡
            if (theme === 'default') {
                document.documentElement.style.setProperty('--primary', '#4a6fa5');
                document.documentElement.style.setProperty('--primary-light', '#6b8cbc');
                document.documentElement.style.setProperty('--secondary', '#ff7e5f');
                document.documentElement.style.setProperty('--background', '#f8f9fa');
                document.documentElement.style.setProperty('--card', '#ffffff');
            } else if (theme === 'dark') {
                document.documentElement.style.setProperty('--primary', '#343a40');
                document.documentElement.style.setProperty('--primary-light', '#6c757d');
                document.documentElement.style.setProperty('--secondary', '#6c757d');
                document.documentElement.style.setProperty('--background', '#2c3e50');
                document.documentElement.style.setProperty('--card', '#34495e');
            } else if (theme === 'green') {
                document.documentElement.style.setProperty('--primary', '#28a745');
                document.documentElement.style.setProperty('--primary-light', '#20c997');
                document.documentElement.style.setProperty('--secondary', '#20c997');
                document.documentElement.style.setProperty('--background', '#e8f5e9');
                document.documentElement.style.setProperty('--card', '#ffffff');
            } else if (theme === 'pink') {
                document.documentElement.style.setProperty('--primary', '#e83e8c');
                document.documentElement.style.setProperty('--primary-light', '#fd7e14');
                document.documentElement.style.setProperty('--secondary', '#fd7e14');
                document.documentElement.style.setProperty('--background', '#fff0f6');
                document.documentElement.style.setProperty('--card', '#ffffff');
            }
        }
    </script>
</body>
</html>